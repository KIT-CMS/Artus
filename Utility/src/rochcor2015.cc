//#define rochcor2015_cxx
#include "Artus/Utility/interface/rochcor2015.h"
#include "TLorentzVector.h"


const double rochcor2015::netabin[25] = {-2.4,-2.25,-2.1,-1.85,-1.6,-1.4,-1.2,-1.0,-0.8,-0.6,-0.4,-0.2,
					 0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};

const double rochcor2015::anetabin[13] = {0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};


//---------------------------------------------------------------------------------------------  
const double rochcor2015::dcor_bf[16][24]={{-0.000112153,0.000038182,-0.000073383,0.000010769,-0.000013738,-0.000029657,0.000010070,-0.000023264,0.000021642,0.000100152,0.000056161,-0.000021421,0.000055797,0.000026454,0.000052002,0.000003118,0.000035248,-0.000066958,0.000016543,-0.000005824,0.000028966,-0.000095415,-0.000018573,0.000061510},
{-0.000112766,0.000004384,-0.000012679,0.000028634,0.000011680,0.000013815,0.000033953,0.000036881,0.000090353,0.000051690,0.000085323,0.000032724,0.000113471,0.000066442,0.000039527,0.000091354,0.000077211,0.000035261,-0.000048800,-0.000005668,-0.000031384,-0.000127302,-0.000104118,0.000031345},
{0.000049014,0.000020452,-0.000099249,-0.000014900,-0.000041171,-0.000012473,0.000046422,0.000076543,0.000016778,0.000075058,0.000032062,0.000055583,0.000037349,0.000056650,0.000056677,-0.000000403,0.000000112,0.000018211,0.000004043,-0.000032005,0.000003592,0.000079625,0.000034745,-0.000145932},
{0.000080876,0.000041611,0.000025790,-0.000079068,0.000003360,-0.000001399,0.000010761,-0.000021766,-0.000006716,0.000013148,0.000072493,0.000033082,0.000075683,0.000052914,0.000097734,0.000063196,-0.000037993,-0.000012007,-0.000005662,-0.000055862,0.000024512,-0.000069333,-0.000120348,-0.000089530},
{-0.000049314,-0.000126367,-0.000003777,-0.000064471,-0.000069302,-0.000060506,-0.000022613,-0.000077475,0.000056477,-0.000038979,0.000050117,0.000028478,0.000110242,0.000048877,0.000057872,-0.000010721,-0.000005147,0.000026482,0.000017572,0.000036523,0.000009617,-0.000078070,0.000019068,-0.000115037},
{-0.000030593,0.000016977,-0.000017165,-0.000007003,-0.000001466,-0.000017852,-0.000027303,0.000006322,0.000102459,0.000011303,0.000027815,0.000015257,0.000043603,-0.000002962,-0.000051386,0.000063065,0.000073939,0.000046745,0.000013593,-0.000022707,0.000007169,0.000031191,0.000069389,-0.000035549},
{-0.000046598,-0.000028772,-0.000028330,-0.000033090,-0.000041733,0.000001529,-0.000009305,0.000013129,-0.000006410,0.000063574,0.000003714,-0.000036141,0.000005528,-0.000006964,-0.000037148,0.000012578,0.000030498,-0.000068020,-0.000052914,-0.000051891,-0.000148299,-0.000085210,0.000012518,-0.000064982},
{0.000001668,-0.000171965,-0.000064226,0.000042184,-0.000034202,0.000014875,0.000015854,0.000145456,0.000026505,0.000078104,0.000000605,0.000055856,0.000067407,-0.000028443,-0.000050863,0.000041677,0.000037958,0.000059037,-0.000007807,-0.000090813,-0.000096459,0.000008275,-0.000057223,0.000003754},
{-0.000057581,-0.000110506,-0.000019533,-0.000049200,-0.000017634,0.000087155,0.000026689,-0.000062049,-0.000067718,0.000044096,0.000064254,0.000021572,-0.000026884,-0.000038738,-0.000012341,0.000013019,0.000043030,0.000035026,0.000048103,-0.000083640,-0.000067845,0.000023456,-0.000063580,0.000078844},
{-0.000086131,-0.000038662,-0.000025699,-0.000059662,-0.000070261,0.000006742,0.000048530,0.000013012,0.000050257,0.000087862,0.000024695,0.000042747,0.000101532,0.000061288,-0.000028361,0.000109323,-0.000011255,0.000028252,-0.000039986,0.000026293,0.000057248,-0.000107799,-0.000125502,-0.000063023},
{0.000097523,-0.000036677,-0.000013505,0.000010171,-0.000021535,-0.000005316,0.000011520,0.000004897,-0.000032206,0.000011962,0.000031497,0.000047777,0.000097227,0.000050213,0.000017857,0.000033967,-0.000010900,-0.000086736,-0.000057364,0.000003254,-0.000030907,-0.000100366,-0.000128872,-0.000050360},
{0.000005019,-0.000006283,-0.000053890,-0.000125058,0.000089588,-0.000052544,0.000054161,0.000052840,0.000070985,0.000027846,0.000046905,0.000024142,0.000068620,0.000034676,0.000013785,0.000002941,0.000047260,0.000024750,0.000012173,0.000054145,-0.000069088,-0.000138210,-0.000080681,-0.000206672},
{-0.000091437,-0.000189001,-0.000018420,0.000014790,-0.000038668,-0.000028818,0.000060812,0.000020346,0.000004864,0.000030495,0.000047031,0.000008480,0.000087954,-0.000007778,-0.000013844,0.000018931,-0.000016583,-0.000045114,-0.000022431,-0.000101980,-0.000017601,-0.000047348,-0.000052424,-0.000092138},
{-0.000026431,-0.000088464,0.000008389,-0.000033500,-0.000013671,-0.000024666,-0.000050432,0.000114048,0.000043988,0.000020997,0.000073464,0.000056370,0.000011254,0.000061948,0.000033978,-0.000018801,0.000089254,0.000004693,-0.000089923,-0.000119730,-0.000014083,-0.000060400,-0.000046763,-0.000115263},
{0.000032030,-0.000023370,-0.000101092,0.000001018,-0.000051983,-0.000030012,0.000019895,0.000047773,0.000029565,0.000056056,0.000039401,0.000127377,0.000000744,0.000033586,0.000164282,0.000064379,0.000001100,0.000007105,0.000021715,-0.000096891,-0.000036933,-0.000135361,0.000012820,-0.000024658},
{-0.000030810,-0.000088614,-0.000125852,-0.000031846,-0.000088433,-0.000046052,0.000028196,0.000008605,0.000060344,-0.000024166,0.000049437,0.000067229,0.000048264,-0.000025659,0.000084270,0.000039769,0.000021277,0.000027021,0.000038767,-0.000042277,-0.000125268,-0.000089917,0.000046911,-0.000128267}};
const double rochcor2015::dcor_ma[16][24]={{0.000856972,0.000573708,0.000310359,0.000175876,0.000144526,0.000108980,0.000039284,0.000047843,0.000081189,0.000041514,0.000010058,0.000079439,0.000047770,-0.000014104,0.000051320,0.000014976,0.000012146,0.000046486,0.000031597,0.000090181,0.000065125,0.000160442,0.000276048,0.000205255},
{0.000910505,0.000637289,0.000311028,0.000140909,0.000113803,0.000043066,0.000005802,0.000027404,0.000036922,0.000030871,-0.000016584,-0.000013795,0.000040471,0.000044934,0.000010876,0.000037212,0.000016329,0.000046939,0.000098067,0.000139193,0.000111461,0.000227153,0.000205563,0.000297937},
{0.000794006,0.000507543,0.000243174,0.000125389,0.000108285,0.000072114,-0.000052379,0.000059792,0.000018770,0.000072054,0.000014750,0.000056737,0.000003461,0.000025763,0.000041115,0.000010852,0.000020302,0.000040970,0.000056791,0.000146652,0.000172853,0.000198716,0.000302313,0.000453738},
{0.000478098,0.000284287,-0.000027541,0.000008036,0.000049060,-0.000044815,0.000022355,0.000010290,0.000004665,0.000028737,0.000000934,0.000015712,0.000011216,-0.000006415,-0.000002871,-0.000009651,0.000011708,0.000074508,0.000079685,0.000117834,0.000021112,0.000150856,0.000193218,0.000221258},
{-0.000104249,0.000006155,-0.000064229,-0.000000263,-0.000000691,-0.000103244,0.000034657,-0.000021710,0.000006959,-0.000021263,-0.000005213,-0.000025911,-0.000051452,-0.000027904,-0.000008481,0.000003489,0.000029886,0.000033771,-0.000062741,-0.000011118,0.000086927,0.000063823,0.000106365,0.000231288},
{-0.000453155,-0.000213070,-0.000179358,-0.000057906,-0.000175984,-0.000071700,0.000035742,-0.000021879,0.000072768,-0.000032366,0.000007984,-0.000032026,-0.000026349,-0.000014969,-0.000025495,-0.000023397,-0.000064582,-0.000057343,-0.000038827,-0.000149607,-0.000072829,0.000006493,0.000091364,0.000024560},
{-0.000853047,-0.000436919,-0.000268021,-0.000173070,-0.000129962,0.000025925,-0.000024490,-0.000001224,-0.000042245,-0.000024464,-0.000011512,-0.000025273,0.000019374,-0.000016264,-0.000126195,-0.000032169,-0.000042034,-0.000030033,-0.000019860,-0.000104710,-0.000121075,-0.000084197,0.000014547,0.000039068},
{-0.000756424,-0.000481089,-0.000270306,-0.000162882,-0.000115232,-0.000068404,-0.000055154,0.000027372,-0.000009202,-0.000025576,-0.000036317,-0.000015580,0.000004671,-0.000057363,0.000007098,0.000039465,-0.000008693,0.000052267,-0.000066111,-0.000056754,-0.000110837,-0.000092556,-0.000072272,0.000009339},
{-0.000814336,-0.000439338,-0.000366859,-0.000102418,-0.000101561,0.000002094,0.000033966,0.000003685,-0.000004856,-0.000021922,-0.000001136,0.000024239,0.000014320,0.000016139,0.000001501,0.000016779,0.000004601,-0.000029391,-0.000017669,-0.000007640,-0.000042732,-0.000061009,-0.000144835,0.000151423},
{-0.000789169,-0.000566329,-0.000224245,-0.000185145,-0.000060957,-0.000063000,0.000031307,-0.000021671,-0.000026157,-0.000098061,-0.000017849,-0.000024206,0.000019038,-0.000010634,0.000039509,-0.000012481,0.000063036,0.000045384,0.000038723,-0.000004828,-0.000015023,-0.000088798,0.000068592,0.000094966},
{-0.000540972,-0.000447403,-0.000232935,-0.000075387,-0.000112568,-0.000045285,-0.000053254,0.000006401,-0.000048551,0.000021801,-0.000004783,0.000044310,-0.000039901,-0.000018865,0.000031159,-0.000014438,-0.000099355,-0.000010220,-0.000064414,-0.000033774,0.000026004,-0.000113048,-0.000135545,-0.000130815},
{-0.000353219,-0.000253823,-0.000124401,-0.000071902,-0.000042816,0.000010638,0.000017923,-0.000073523,-0.000052029,-0.000013373,-0.000002697,-0.000010481,-0.000039860,0.000031768,0.000003672,0.000010764,0.000001399,-0.000072702,-0.000033201,0.000003516,-0.000086528,-0.000116637,-0.000116093,-0.000089719},
{0.000094992,-0.000032331,0.000007360,-0.000005477,-0.000044954,-0.000022246,0.000047205,-0.000056661,-0.000043204,-0.000025728,-0.000004504,0.000003851,-0.000016311,-0.000047534,0.000016497,-0.000034501,0.000012539,-0.000024126,-0.000054305,-0.000032317,-0.000077650,-0.000136181,-0.000093790,-0.000099044},
{0.000283738,0.000127981,0.000110973,0.000051984,-0.000035377,0.000030329,0.000011861,0.000075346,-0.000025875,-0.000052815,0.000023924,0.000041083,-0.000005913,-0.000010226,0.000019407,-0.000005713,-0.000085138,0.000030575,-0.000080445,-0.000057929,-0.000082735,-0.000119793,-0.000144902,-0.000127550},
{0.000564215,0.000365488,0.000191087,0.000122144,0.000027667,0.000064741,0.000023854,-0.000005823,0.000005241,0.000008181,-0.000000675,-0.000002711,0.000037605,-0.000020480,0.000027270,-0.000017219,-0.000057430,-0.000039138,-0.000062350,-0.000090115,-0.000046332,-0.000104654,0.000003875,-0.000105550},
{0.000667436,0.000500872,0.000365892,0.000140866,0.000144659,0.000092644,0.000020853,0.000014767,0.000005285,0.000013950,0.000029247,-0.000067912,0.000023296,0.000012705,-0.000015647,-0.000000864,0.000081050,-0.000011556,-0.000014587,-0.000036576,-0.000059240,0.000069237,0.000096010,0.000043771}};
const double rochcor2015::mcor_bf[16][24]={{-0.000042413,-0.000070418,0.000001758,-0.000007204,-0.000002672,0.000007662,0.000023878,0.000032256,0.000077617,0.000054859,0.000044638,0.000067348,0.000067388,0.000073983,0.000068181,0.000045879,0.000016935,0.000017003,0.000030095,0.000049996,0.000008626,-0.000041797,-0.000053557,-0.000009072},
{-0.000000002,-0.000057331,0.000035090,-0.000010748,-0.000000870,0.000020189,0.000065615,0.000044243,0.000050883,0.000078814,0.000057213,0.000069628,0.000042142,0.000054386,0.000043074,0.000057581,0.000048131,0.000060964,0.000023174,-0.000015176,0.000031363,-0.000003811,-0.000051044,-0.000066394},
{0.000041228,-0.000041760,-0.000073040,-0.000020960,0.000025994,-0.000017879,0.000015965,0.000033940,0.000059193,0.000068421,0.000026353,0.000051916,0.000027755,0.000046926,0.000027130,0.000071627,0.000050277,0.000049704,0.000035275,0.000032556,-0.000025409,0.000009284,-0.000067007,-0.000090735},
{0.000020119,-0.000077384,-0.000021279,-0.000015630,0.000025263,0.000014683,0.000032328,0.000030237,0.000014629,0.000002414,0.000061248,0.000038359,0.000063599,0.000063525,0.000054454,0.000051298,0.000013504,0.000054559,0.000002154,0.000011418,-0.000015107,-0.000014783,0.000005769,-0.000124908},
{-0.000040414,-0.000054193,-0.000011100,-0.000046792,-0.000024274,-0.000015265,-0.000012032,0.000029084,0.000033781,0.000021485,0.000090959,0.000048965,0.000038670,0.000045751,0.000051239,0.000028999,0.000013499,0.000010752,0.000009677,-0.000013191,-0.000006937,0.000009391,-0.000015776,-0.000052093},
{-0.000009831,0.000007388,-0.000021951,-0.000028584,0.000022850,0.000027300,0.000027078,0.000025046,0.000054560,0.000045081,0.000053824,0.000037236,0.000068486,0.000017051,0.000008849,0.000017370,0.000053607,0.000107022,-0.000009443,0.000029196,0.000006807,-0.000021274,-0.000054961,-0.000032412},
{-0.000069988,0.000003201,-0.000011666,-0.000027187,-0.000026479,0.000023965,0.000025412,0.000035476,0.000043615,0.000047583,0.000040479,0.000021483,0.000058791,0.000033870,0.000024455,0.000031344,0.000026388,0.000012836,0.000033810,0.000013698,0.000000561,-0.000001919,-0.000056834,-0.000142829},
{0.000055532,-0.000001521,-0.000011558,0.000022708,0.000000455,0.000060525,0.000018562,0.000041266,0.000004773,0.000057627,0.000042601,0.000062431,0.000069397,0.000029934,0.000031741,0.000026699,0.000057110,0.000057498,0.000001573,-0.000000614,0.000024780,-0.000023869,-0.000021100,-0.000069044},
{-0.000075784,-0.000065361,-0.000008899,0.000000601,-0.000010415,0.000054760,0.000068307,0.000015963,0.000034440,0.000054664,0.000045972,0.000040241,0.000066793,0.000036316,0.000025081,0.000054753,0.000034934,0.000042890,0.000052173,-0.000054763,-0.000001531,-0.000016975,0.000029687,-0.000007067},
{-0.000063688,0.000007321,-0.000025625,-0.000017679,-0.000035542,-0.000035344,0.000059276,0.000023660,0.000075757,0.000046568,0.000037343,0.000018948,0.000064910,0.000048229,0.000030970,0.000039785,0.000035322,0.000030253,-0.000030701,0.000008098,0.000018147,-0.000004712,-0.000043065,-0.000054564},
{-0.000045169,-0.000076000,0.000009362,0.000001564,0.000006279,0.000016598,0.000032252,0.000039324,0.000016982,0.000063102,0.000047808,0.000082071,0.000067320,0.000078329,0.000041885,0.000043288,0.000031051,0.000038441,-0.000028889,-0.000000415,0.000011130,-0.000013519,-0.000013377,-0.000114712},
{-0.000054064,0.000043128,0.000010831,-0.000022699,0.000056747,0.000031808,0.000047780,0.000066737,0.000056355,0.000041552,0.000043143,0.000040098,0.000048423,0.000065926,0.000063812,0.000032852,0.000061316,0.000079636,0.000003990,0.000046114,0.000001654,-0.000028831,0.000071798,-0.000020587},
{-0.000086523,-0.000068706,0.000011858,-0.000017491,0.000019828,0.000039492,0.000051580,0.000040143,0.000051015,0.000062685,0.000033302,0.000054540,0.000046102,0.000057578,0.000042283,0.000069571,0.000061226,0.000015600,0.000014986,0.000008349,0.000021153,0.000038116,0.000034613,-0.000047900},
{0.000004547,-0.000037310,-0.000003002,0.000033845,0.000018380,0.000031838,0.000032868,0.000034451,0.000045184,0.000039869,0.000032237,0.000059387,0.000030204,0.000040900,0.000067120,0.000018565,0.000051544,0.000038896,-0.000017884,0.000020429,-0.000006348,0.000018578,-0.000052662,-0.000023476},
{-0.000067756,-0.000019268,-0.000028662,0.000055061,0.000004237,-0.000008195,0.000022988,0.000066733,0.000062685,0.000060390,0.000048586,0.000081381,0.000079908,0.000048727,0.000059171,0.000054983,0.000023845,0.000039101,0.000010414,0.000009760,0.000023084,-0.000033935,0.000075541,-0.000059596},
{-0.000084333,-0.000033371,0.000001643,0.000011023,-0.000006393,-0.000017098,-0.000017843,0.000000812,0.000025513,0.000049285,0.000047536,0.000029186,0.000054008,0.000048965,0.000086836,0.000004016,0.000045111,0.000030901,-0.000001615,0.000031676,-0.000006882,-0.000014911,-0.000021877,-0.000013376}};
const double rochcor2015::mcor_ma[16][24]={{0.000019958,0.000048930,-0.000005584,-0.000045639,0.000018196,-0.000006986,-0.000028467,-0.000002425,-0.000006535,-0.000025504,-0.000047219,-0.000038033,-0.000023732,-0.000031231,-0.000014628,-0.000039017,0.000000910,-0.000001518,0.000023860,0.000016572,-0.000019111,-0.000016524,-0.000047351,0.000014609},
{-0.000043956,-0.000011834,-0.000027848,-0.000026694,0.000021009,-0.000040440,-0.000055930,-0.000048716,-0.000057617,-0.000011702,-0.000020812,-0.000005965,-0.000033200,0.000016029,-0.000044445,-0.000016007,-0.000040476,-0.000025472,-0.000002911,-0.000011137,-0.000015917,0.000041687,0.000014156,0.000044309},
{0.000006451,0.000096597,0.000073477,-0.000008883,-0.000020339,-0.000034192,-0.000081132,-0.000034460,-0.000006099,-0.000025281,-0.000012149,-0.000043242,-0.000023408,-0.000010576,-0.000015963,-0.000007952,-0.000005812,-0.000034691,-0.000016837,0.000036837,0.000031315,0.000057300,0.000056456,0.000125593},
{-0.000030126,-0.000045778,-0.000069396,-0.000014510,-0.000061720,-0.000062190,-0.000019663,-0.000021236,-0.000020204,-0.000031087,-0.000005729,-0.000011731,-0.000027366,-0.000032897,0.000011033,-0.000021435,-0.000014681,-0.000029929,0.000013679,0.000003012,-0.000017262,0.000007214,0.000040527,0.000038887},
{-0.000104399,-0.000089112,-0.000057336,-0.000007246,-0.000012776,-0.000037057,-0.000008010,-0.000006006,-0.000009878,-0.000000910,-0.000004022,0.000022637,0.000027697,-0.000001420,-0.000018258,0.000003583,-0.000003009,0.000027054,-0.000020259,0.000032623,0.000005321,-0.000013834,0.000046337,-0.000033733},
{-0.000015387,0.000021096,-0.000016862,-0.000003541,-0.000032582,0.000022131,0.000009846,-0.000016208,0.000005818,-0.000009968,-0.000002664,-0.000008596,0.000003211,-0.000007295,0.000030808,-0.000002498,-0.000019029,0.000018223,0.000013716,0.000040350,0.000004517,0.000003264,-0.000036230,0.000016689},
{0.000039607,0.000046348,-0.000002855,-0.000009340,-0.000003335,-0.000003348,0.000006620,0.000025668,0.000002959,0.000037655,0.000022517,0.000012210,0.000012845,0.000026175,0.000023223,0.000000909,0.000027985,0.000014356,0.000006014,-0.000023403,-0.000001604,0.000007691,-0.000025925,-0.000021536},
{0.000043495,0.000052896,0.000062384,0.000051928,-0.000003493,0.000030375,0.000028837,0.000005595,0.000030279,0.000006889,0.000001603,0.000015011,0.000016235,0.000002691,0.000017634,0.000039441,0.000021897,0.000041589,-0.000026315,-0.000001050,-0.000029522,0.000011723,-0.000044794,-0.000016109},
{0.000073850,0.000052301,0.000041735,0.000033545,-0.000030343,0.000053799,-0.000000171,0.000018617,0.000013365,0.000014343,0.000019801,0.000009986,0.000015984,0.000012558,0.000013965,-0.000006401,0.000005369,0.000008013,0.000033321,0.000043796,0.000054854,0.000067139,0.000040096,0.000046383},
{0.000061277,0.000003943,-0.000008869,0.000005618,-0.000014751,0.000019799,-0.000006118,0.000002783,0.000012262,-0.000020897,0.000024027,-0.000004535,0.000012919,0.000032778,0.000037545,0.000029573,0.000017121,0.000038373,0.000014268,0.000069585,0.000075068,0.000033749,0.000031200,0.000211415},
{0.000008183,-0.000058106,-0.000095743,-0.000022883,-0.000042369,-0.000042394,-0.000012072,-0.000022854,-0.000006919,0.000013060,0.000022817,-0.000006695,-0.000000376,-0.000002744,-0.000002208,0.000003981,-0.000018062,-0.000002132,-0.000002186,0.000012810,0.000060872,0.000039747,0.000043637,0.000027180},
{-0.000100004,-0.000024605,-0.000026342,-0.000010860,-0.000025081,-0.000000510,-0.000017789,-0.000012307,-0.000023141,0.000000780,-0.000011443,-0.000005350,0.000016947,-0.000003142,0.000012022,0.000009322,0.000022103,0.000003687,0.000019497,0.000004932,0.000040767,-0.000004847,0.000106264,0.000087158},
{-0.000039315,-0.000039613,0.000001460,-0.000037209,-0.000014879,-0.000054265,-0.000010039,-0.000028207,-0.000028669,-0.000031202,-0.000028392,-0.000010967,0.000024685,0.000011105,-0.000001288,-0.000005439,0.000004854,0.000007675,-0.000043540,-0.000001072,-0.000005790,0.000026836,0.000035431,0.000035520},
{-0.000034538,-0.000040861,-0.000029458,-0.000030861,-0.000026143,-0.000040735,-0.000049040,-0.000013960,-0.000060747,-0.000016401,-0.000015918,-0.000035441,-0.000032783,-0.000003555,-0.000010219,-0.000037917,-0.000027299,0.000031002,-0.000045203,-0.000003306,-0.000038460,-0.000026057,-0.000040523,-0.000038812},
{-0.000057426,-0.000049841,-0.000023764,-0.000063027,-0.000048833,-0.000056452,-0.000038295,-0.000052719,-0.000040980,-0.000021223,-0.000022961,-0.000044645,-0.000013279,-0.000004411,-0.000014654,-0.000017768,-0.000024997,-0.000063172,-0.000029167,-0.000008874,-0.000043699,-0.000077771,-0.000013362,-0.000054559},
{0.000001795,0.000043233,-0.000005651,0.000025606,0.000004468,-0.000028602,-0.000035903,-0.000054163,-0.000029384,-0.000034249,-0.000025632,-0.000043669,-0.000061261,-0.000043620,-0.000041681,-0.000021390,-0.000017927,-0.000063186,-0.000031347,-0.000078629,-0.000051630,-0.000025029,-0.000094046,-0.000192682}};
//==========================================================================================================================
const double rochcor2015::dmavg[16][24]={{0.025888221,0.025324721,0.025232796,0.024790031,0.024728495,0.024717085,0.024701121,0.024922064,0.024939570,0.025179845,0.025139764,0.025551151,0.025455612,0.025151218,0.025020231,0.024914573,0.024735836,0.024696888,0.024932879,0.024687104,0.024758418,0.025168500,0.025362882,0.025692869},
{0.025791260,0.025400329,0.025233015,0.024905786,0.024677687,0.024563455,0.024756685,0.024610423,0.024910694,0.025070701,0.025146443,0.025277313,0.025220652,0.025162782,0.025210407,0.024888201,0.024957854,0.024636797,0.024575364,0.024800538,0.024740200,0.025323210,0.025548935,0.025482657},
{0.025625508,0.025183258,0.025110540,0.024803041,0.024507517,0.024823406,0.024732782,0.024894015,0.024938739,0.025103294,0.025184842,0.025308606,0.025429318,0.025467687,0.025244835,0.024937232,0.024770253,0.024803412,0.024746703,0.024845146,0.024875789,0.024951234,0.025189820,0.025747301},
{0.025506863,0.025226158,0.025040091,0.024850174,0.024778542,0.024607455,0.024610922,0.024817088,0.024918449,0.024987469,0.025163809,0.025396225,0.025597075,0.025323537,0.025026474,0.024973769,0.024749078,0.024896082,0.024607213,0.024773827,0.024783373,0.025078064,0.025311376,0.025603441},
{0.025504170,0.025536850,0.024865004,0.024775942,0.024663857,0.024734313,0.024859249,0.024894439,0.024903834,0.025314406,0.025191319,0.025418684,0.025359755,0.025280604,0.025127624,0.025138168,0.024886100,0.024675363,0.024849830,0.024697611,0.024835751,0.024987682,0.025246845,0.025730640},
{0.025573846,0.025393624,0.025042118,0.024914925,0.024608571,0.024721555,0.024658078,0.024945447,0.024945271,0.025086963,0.025378610,0.025410151,0.025424047,0.025377705,0.025127367,0.024972573,0.024765249,0.024721586,0.024663927,0.024648406,0.024717915,0.025139432,0.025544116,0.025661237},
{0.025598103,0.025319410,0.024989541,0.024944618,0.024727584,0.024665110,0.024693302,0.024773227,0.024975830,0.025027912,0.025223129,0.025554571,0.025242305,0.025349220,0.025041686,0.024927399,0.024692930,0.024900299,0.024801294,0.024670660,0.024926554,0.025136491,0.025493844,0.025410394},
{0.025669005,0.025504343,0.025201056,0.024938316,0.024721696,0.024852037,0.024560876,0.024800768,0.024756804,0.025077826,0.025302692,0.025298757,0.025353009,0.025336528,0.025248639,0.024905170,0.024820155,0.024571220,0.024559560,0.024661179,0.024922303,0.025134694,0.025479694,0.025527586},
{0.025546758,0.025315258,0.025012318,0.025024404,0.024742138,0.024734854,0.024673841,0.024857924,0.024989839,0.025098255,0.025154697,0.025435639,0.025412408,0.025368391,0.025192388,0.024805839,0.024734886,0.024705693,0.024593940,0.024786836,0.024775417,0.025062426,0.025206936,0.025817503},
{0.025718131,0.024973193,0.025109005,0.024804539,0.024694008,0.024621071,0.024573488,0.024918892,0.025115787,0.025078129,0.025047585,0.025337553,0.025307965,0.025209201,0.024993136,0.024846729,0.024678359,0.024811692,0.024712984,0.024574441,0.024731678,0.025131975,0.025263762,0.025673349},
{0.025552272,0.025209096,0.025378815,0.024868109,0.024642754,0.024870713,0.024713354,0.024939691,0.024851760,0.025186883,0.025288047,0.025392785,0.025243272,0.025135465,0.025168296,0.024787824,0.024615908,0.024824914,0.024563463,0.024480025,0.024867241,0.025044382,0.025504545,0.025581965},
{0.025486355,0.025125205,0.025101815,0.024882496,0.024778422,0.024663148,0.024681481,0.024779413,0.024976095,0.025180962,0.025301283,0.025466615,0.025178292,0.025234150,0.025169336,0.025007677,0.024817718,0.024718625,0.024668209,0.024712284,0.024846547,0.025137693,0.025464864,0.025613453},
{0.025750104,0.025272465,0.025062066,0.024899847,0.024745083,0.024730971,0.024830208,0.024908807,0.025081648,0.025184627,0.025281746,0.025353403,0.025172828,0.025431998,0.025062796,0.024888877,0.024774982,0.024610212,0.024733693,0.024912362,0.024939499,0.025172131,0.025429862,0.025695992},
{0.025723179,0.025403341,0.025079337,0.024954777,0.024704329,0.024878964,0.024718839,0.024709545,0.024904448,0.025009159,0.025321690,0.025350291,0.025432141,0.025201879,0.025113379,0.024844511,0.024776328,0.024693073,0.024789657,0.024915261,0.024819312,0.025228598,0.025497341,0.025475054},
{0.025741328,0.025418684,0.025098528,0.024937185,0.024702572,0.024861372,0.024721817,0.024804266,0.025143366,0.025015634,0.025352127,0.025327270,0.025366328,0.025331312,0.024848394,0.024827405,0.024742633,0.024903449,0.024679655,0.024762011,0.024835681,0.025198774,0.025655856,0.025623030},
{0.025627074,0.025369877,0.025171615,0.024800743,0.024856018,0.024767748,0.024708020,0.024712089,0.024943768,0.025106568,0.025254844,0.025355188,0.025217541,0.025370601,0.025062929,0.024855334,0.024940935,0.024813180,0.024387135,0.024790591,0.024786860,0.025343866,0.025373650,0.025693042}};
const double rochcor2015::dpavg[16][24]={{0.025871862,0.025143111,0.025271470,0.024824377,0.024576140,0.024602610,0.024580976,0.024758205,0.025071447,0.025164151,0.025251640,0.025427304,0.025536167,0.025392903,0.025027156,0.024955204,0.024912568,0.024703622,0.024631239,0.024715860,0.024850518,0.025174722,0.025238046,0.025669972},
{0.025876211,0.025171915,0.025031291,0.024732820,0.024666627,0.024666131,0.024831009,0.024826238,0.024881574,0.025153787,0.025183417,0.025431867,0.025338012,0.025384441,0.025147037,0.024953820,0.024771807,0.024715238,0.024733412,0.024721044,0.024807699,0.025164170,0.025504041,0.025595144},
{0.025526761,0.025108578,0.025221811,0.024778037,0.024701624,0.024801406,0.024723469,0.024732296,0.024936509,0.025009282,0.025299423,0.025443566,0.025405361,0.025392142,0.025134167,0.025102823,0.024882972,0.024657257,0.024686716,0.024825615,0.024721800,0.024938743,0.025227669,0.025631105},
{0.025362707,0.025204784,0.025056026,0.024982048,0.024651766,0.024524059,0.024719646,0.024811809,0.025014279,0.025099122,0.025239423,0.025537543,0.025430533,0.025173436,0.025096540,0.024846780,0.024884293,0.024828087,0.024673258,0.024714902,0.024788206,0.025217551,0.025325186,0.025483428},
{0.025585675,0.025291306,0.024966859,0.024684344,0.024839109,0.024790534,0.024664812,0.024904346,0.025084970,0.025285507,0.025409802,0.025450469,0.025410098,0.025269588,0.025070993,0.025065660,0.024906639,0.024542635,0.024711566,0.024569326,0.024826911,0.025203799,0.025174681,0.025595423},
{0.025693175,0.025652208,0.025081594,0.024633587,0.024744235,0.024747891,0.024720220,0.024742624,0.024959773,0.025376058,0.025265881,0.025289836,0.025376991,0.025153025,0.025107700,0.024948884,0.024833459,0.024754519,0.024568457,0.024871721,0.024851731,0.025165384,0.025384673,0.025941678},
{0.025972586,0.025707817,0.025111755,0.024719606,0.024727770,0.024634345,0.024676540,0.024691395,0.025048742,0.025095872,0.025285723,0.025330914,0.025277577,0.025295906,0.025257332,0.024945548,0.024723968,0.024923433,0.024663817,0.024884540,0.025005661,0.025360025,0.025474307,0.025630134},
{0.025991797,0.025729421,0.025052897,0.025045006,0.024691732,0.024664566,0.024611858,0.024780245,0.024952814,0.024824546,0.025242907,0.025415909,0.025388721,0.025330310,0.025150949,0.024915508,0.024876847,0.024732933,0.024630439,0.024948871,0.025101875,0.025235457,0.025343906,0.026058248},
{0.025718144,0.025587372,0.025192472,0.024962542,0.024702179,0.024603760,0.024635876,0.024964925,0.025071320,0.025298412,0.025343638,0.025388318,0.025462631,0.025194753,0.024943477,0.024942641,0.025015897,0.024713811,0.024592498,0.024841283,0.024954314,0.025065292,0.025405437,0.025595309},
{0.025956690,0.025462534,0.025209903,0.025020622,0.024607341,0.024698824,0.024627397,0.024822863,0.024977567,0.025089147,0.025219827,0.025391595,0.025196921,0.025189181,0.025036485,0.024862142,0.024687552,0.024676376,0.024714126,0.024724366,0.024896820,0.025138717,0.025155659,0.025873672},
{0.025698390,0.025593879,0.025133972,0.024919946,0.024910702,0.024648457,0.024796640,0.024828316,0.025058149,0.025139900,0.025259255,0.025302154,0.025341607,0.025360815,0.025043296,0.024999947,0.024845860,0.024747683,0.024618598,0.024971350,0.024838179,0.025148563,0.025488202,0.025759621},
{0.025471648,0.025541550,0.025342409,0.025069031,0.024755863,0.024684801,0.024519398,0.024760970,0.024922488,0.025193599,0.025105880,0.025326851,0.025320730,0.025238137,0.025223355,0.024803452,0.024887978,0.024882454,0.024600219,0.024649269,0.025072382,0.025297996,0.025844121,0.025925951},
{0.025740797,0.025422918,0.025109548,0.024726988,0.024718488,0.024778091,0.024607516,0.024806111,0.025069267,0.025090011,0.025470957,0.025210915,0.025259454,0.025465440,0.025157992,0.024892914,0.024859113,0.024755939,0.024761474,0.024842973,0.025018749,0.025088568,0.025409471,0.025754340},
{0.025615868,0.025165061,0.024995450,0.024923459,0.024822724,0.024665129,0.024867750,0.024699181,0.024940100,0.025070024,0.025159519,0.025297614,0.025463730,0.025094495,0.025160835,0.024925687,0.024779569,0.024857663,0.024675309,0.024846876,0.024724726,0.025115493,0.025503607,0.025575797},
{0.025346956,0.025162891,0.025034752,0.024881398,0.024735436,0.024622199,0.024711146,0.024763183,0.024912288,0.025282839,0.025220323,0.025360272,0.025541044,0.025214898,0.024912224,0.025146905,0.024910274,0.024702448,0.024830506,0.024873596,0.024872580,0.025327871,0.025518459,0.025635625},
{0.025510049,0.025545907,0.025254961,0.025021774,0.024970291,0.024653407,0.024678797,0.024710078,0.024928494,0.025125786,0.025290841,0.025352811,0.025268258,0.025276923,0.025182060,0.024926413,0.024778965,0.024667782,0.024600543,0.024923929,0.025042974,0.025251795,0.025599710,0.025641341}};
const double rochcor2015::mmavg[16][24]={{0.025259435,0.025376460,0.025084771,0.024836597,0.024758329,0.024525137,0.024623127,0.024764543,0.024743793,0.025280181,0.025300461,0.025226814,0.025322194,0.025365308,0.025000883,0.024949695,0.024864154,0.024636018,0.024713362,0.024598851,0.024918752,0.024976479,0.025298810,0.025594654},
{0.025446156,0.025359194,0.025113267,0.024892284,0.024897876,0.024495254,0.024805054,0.024831903,0.024979662,0.025103945,0.025291304,0.025333060,0.025444107,0.025368449,0.025148862,0.025026899,0.024934354,0.024655849,0.024570175,0.024696536,0.024725997,0.024974030,0.025390161,0.025537670},
{0.025480630,0.025400695,0.024923554,0.024831296,0.024519260,0.024586850,0.024955751,0.024850704,0.024894520,0.025018164,0.025265523,0.025351003,0.025547049,0.025381217,0.025220006,0.024840275,0.024798589,0.024724589,0.024691970,0.024581799,0.024775561,0.025229350,0.025349509,0.025250646},
{0.025475872,0.025239221,0.025342464,0.024905781,0.024644334,0.024614593,0.024780983,0.024748645,0.024918660,0.025104927,0.025493528,0.025462147,0.025466610,0.025318069,0.025244413,0.025047506,0.024583246,0.024493034,0.024545664,0.024560057,0.024946784,0.024932485,0.025202001,0.025523207},
{0.025618835,0.025099879,0.024979390,0.024655460,0.024651506,0.024719893,0.024658432,0.024750992,0.024997815,0.024909417,0.025352748,0.025373834,0.025575920,0.025436968,0.025234018,0.024977374,0.024876446,0.024920767,0.024835023,0.024633612,0.024631749,0.024940875,0.025484138,0.025350168},
{0.025573842,0.025271221,0.025066251,0.024922162,0.025019630,0.024865201,0.024607930,0.024918234,0.024937935,0.025004068,0.025331135,0.025407393,0.025457233,0.025295420,0.025126829,0.024930456,0.024791098,0.024745271,0.024665122,0.024882829,0.024816788,0.024931462,0.025526478,0.025648982},
{0.025767564,0.025520290,0.024900397,0.024825005,0.024617642,0.024416162,0.024669375,0.024942986,0.024979761,0.025094114,0.025271873,0.025277266,0.025387877,0.025413768,0.025167892,0.024904339,0.024815356,0.024552119,0.024409400,0.024623554,0.024768659,0.025133076,0.025195748,0.025794972},
{0.025710588,0.025307878,0.025004097,0.024962110,0.024763734,0.024679848,0.024857603,0.024804857,0.024944117,0.025214021,0.025375494,0.025436642,0.025309261,0.025387273,0.025093445,0.024978428,0.024773129,0.024678058,0.024594339,0.024739442,0.024667254,0.025201902,0.025297288,0.025476675},
{0.025369141,0.025077557,0.025079544,0.024706185,0.024623848,0.024766344,0.024769536,0.024603514,0.024798711,0.025208126,0.025241707,0.025218430,0.025313993,0.025185399,0.025059688,0.024905884,0.024751699,0.024867062,0.024732276,0.024604942,0.024797110,0.025159822,0.025425541,0.025621587},
{0.025600909,0.025410809,0.025089130,0.024864971,0.024749176,0.024945068,0.024491894,0.024892448,0.024896475,0.025375212,0.025162049,0.025325709,0.025454137,0.025394119,0.024995307,0.025036222,0.024708552,0.024620750,0.024589619,0.024752712,0.024881621,0.024993772,0.025194455,0.025544167},
{0.025509539,0.025513306,0.025166717,0.024710932,0.024890970,0.024668634,0.024731744,0.024693203,0.025006185,0.025002469,0.025332518,0.025220581,0.025471161,0.025148047,0.025069224,0.024898854,0.024900507,0.024581364,0.024718266,0.024595293,0.024755920,0.025066044,0.025271741,0.025442630},
{0.025582298,0.025116529,0.024980246,0.024762471,0.024861429,0.024463094,0.024658748,0.024999974,0.025237369,0.025178712,0.025249622,0.025471143,0.025289472,0.025082082,0.025164369,0.024951259,0.024900420,0.024708307,0.024820580,0.024565788,0.024849825,0.025111786,0.025132986,0.025244787},
{0.025460371,0.025372075,0.025043839,0.024769590,0.024576078,0.024494521,0.024594112,0.024947346,0.024971670,0.025096534,0.025433762,0.025342334,0.025490415,0.025294728,0.025048308,0.024870126,0.024795969,0.024616209,0.024547412,0.024753258,0.024841822,0.025309786,0.025214414,0.025433776},
{0.025544117,0.025232662,0.025171036,0.024944371,0.024782188,0.024719405,0.024693118,0.024909281,0.024911653,0.025053112,0.025385932,0.025316715,0.025367803,0.025310980,0.025095440,0.024878107,0.024947162,0.024587024,0.024631326,0.024631390,0.024777667,0.025042741,0.025378881,0.025255696},
{0.025567437,0.025313257,0.025066944,0.024821381,0.024656477,0.024628760,0.024832345,0.024763339,0.025056393,0.025135168,0.025397588,0.025416021,0.025322393,0.025366927,0.025156187,0.024911883,0.024759401,0.024859892,0.024755658,0.024806477,0.024739000,0.024811631,0.025207651,0.025448750},
{0.025573092,0.025381272,0.024824847,0.024808530,0.024391260,0.024586564,0.024824667,0.024889317,0.025008970,0.025051120,0.025263245,0.025651530,0.025347361,0.025083362,0.025224396,0.025073934,0.024722086,0.024754995,0.024584929,0.024779029,0.024684944,0.024923819,0.025400139,0.025412091}};
const double rochcor2015::mpavg[16][24]={{0.025720149,0.025313519,0.025034486,0.024742273,0.024715410,0.024681472,0.024647259,0.024750580,0.024947720,0.025313370,0.025435407,0.025419511,0.025498857,0.025298899,0.025251995,0.024889759,0.024774657,0.024780777,0.024737381,0.024785253,0.024897763,0.025022334,0.025412416,0.025574903},
{0.025825597,0.025243487,0.025049120,0.024849151,0.024661680,0.024678090,0.024761827,0.024872549,0.025037575,0.025155709,0.025208213,0.025370026,0.025568508,0.025346978,0.025185588,0.024990654,0.024916452,0.024845037,0.024694616,0.024894222,0.024808203,0.025040345,0.025225319,0.025647854},
{0.025772986,0.025346374,0.024859115,0.024796302,0.024694628,0.024803757,0.024742713,0.024947635,0.024842737,0.025237343,0.025291749,0.025424340,0.025432394,0.025355062,0.025320733,0.025010800,0.024784472,0.024618775,0.024934537,0.024802222,0.024797746,0.025236177,0.025199447,0.025515373},
{0.025355319,0.025417408,0.024975476,0.024796327,0.024654886,0.024674767,0.024683452,0.024824730,0.024834164,0.025189996,0.025326898,0.025518035,0.025469406,0.025382656,0.025167980,0.025028426,0.024875033,0.024887151,0.024742455,0.024804142,0.024712923,0.025099413,0.025116113,0.025475870},
{0.025562489,0.025190182,0.025077870,0.024926266,0.024774314,0.024422473,0.024644105,0.024578253,0.025196081,0.025147269,0.025418767,0.025438150,0.025308489,0.025310363,0.025189081,0.025034298,0.024768905,0.024826272,0.024761600,0.024643514,0.024760255,0.024999868,0.025435571,0.025411660},
{0.025411999,0.025446829,0.025133142,0.024754136,0.024481434,0.024600946,0.024577041,0.024795540,0.025152817,0.025178107,0.025318702,0.025442022,0.025502101,0.025084863,0.025052918,0.025118102,0.024831738,0.024602844,0.024670493,0.024590346,0.024851711,0.024978624,0.025548543,0.025636907},
{0.025510854,0.025243130,0.025049676,0.024777235,0.024645809,0.024724469,0.024767013,0.024708711,0.024821721,0.025011883,0.025231231,0.025294389,0.025464582,0.025430039,0.024939513,0.024990313,0.024820003,0.024695529,0.024826262,0.024764763,0.024652687,0.025084894,0.025596228,0.025518456},
{0.025878596,0.025140303,0.025237676,0.024750907,0.024666553,0.024649606,0.024567281,0.025092372,0.025030819,0.024950424,0.025202471,0.025446520,0.025535660,0.025123953,0.025028801,0.024955203,0.024838887,0.024994187,0.024722379,0.024778956,0.024871542,0.025155400,0.025346203,0.025702334},
{0.025582026,0.025420230,0.025046397,0.024911073,0.024648190,0.024877403,0.024775734,0.024827980,0.024956638,0.025260512,0.025305964,0.025356599,0.025369694,0.025160034,0.025090412,0.024964489,0.025039072,0.024665001,0.024827712,0.024720280,0.024719484,0.025059831,0.025063178,0.025737097},
{0.025588251,0.025229213,0.025193747,0.024722925,0.024505335,0.024832869,0.024728134,0.024850951,0.024919346,0.025134913,0.025396495,0.025393851,0.025461067,0.025288704,0.025125250,0.024955486,0.024807978,0.024891833,0.024845999,0.024797834,0.024869017,0.024768296,0.025185061,0.025864937},
{0.025623818,0.025413499,0.025255114,0.024837897,0.024740985,0.024635829,0.024859096,0.024886543,0.024801747,0.025103271,0.025202801,0.025480960,0.025420424,0.025341532,0.025121139,0.025002411,0.024769874,0.024686774,0.024700915,0.024738053,0.024873716,0.025031803,0.025101765,0.025794619},
{0.025589741,0.025331066,0.025196354,0.024884476,0.024803280,0.024627230,0.024749330,0.024827078,0.025055135,0.025140151,0.025181551,0.025503276,0.025556680,0.025299190,0.025299187,0.024987668,0.024886562,0.024791583,0.024818770,0.024776503,0.024752433,0.025092964,0.025219665,0.025423356},
{0.026026201,0.025273489,0.024981656,0.024905063,0.024500480,0.024565397,0.024857949,0.024830731,0.025032645,0.025108322,0.025450527,0.025345421,0.025405867,0.025111666,0.025115718,0.024884062,0.024846587,0.024684112,0.024724719,0.024808716,0.024811440,0.025056393,0.025152868,0.025366199},
{0.025587403,0.025350434,0.025153520,0.024696432,0.024873915,0.024623198,0.024514126,0.025016069,0.024810420,0.024955526,0.025362897,0.025322799,0.025355062,0.025235291,0.025136033,0.024972509,0.024783827,0.024737737,0.024586119,0.024478466,0.024773471,0.024948101,0.025449193,0.025689376},
{0.025489285,0.025312160,0.024970144,0.024838617,0.024791878,0.024752037,0.024725296,0.024879190,0.024907738,0.025266154,0.025261408,0.025533922,0.025484826,0.025271879,0.025411143,0.025106621,0.024774045,0.024649621,0.024615949,0.024687099,0.024788467,0.024880853,0.025461402,0.025572396},
{0.025787162,0.025194612,0.025042006,0.024719382,0.024701784,0.024673982,0.024808064,0.024859248,0.025039909,0.025130135,0.025323967,0.025428093,0.025490985,0.025306088,0.025310138,0.025002729,0.024932684,0.024808996,0.024717305,0.024753224,0.024730783,0.025131497,0.025611163,0.025480601}};
//==========================================================================================================================
const double rochcor2015::dcor_bfer[16][24]={{0.000143480,0.000136315,0.000100489,0.000091843,0.000099247,0.000093916,0.000091279,0.000088392,0.000087553,0.000085309,0.000086810,0.000084988,0.000085617,0.000085823,0.000085146,0.000087415,0.000090710,0.000091464,0.000092869,0.000098547,0.000092061,0.000101018,0.000136489,0.000147642},
{0.000146551,0.000138216,0.000099145,0.000093005,0.000097653,0.000095000,0.000091333,0.000088472,0.000086473,0.000086130,0.000088251,0.000085333,0.000085684,0.000086363,0.000085184,0.000086928,0.000089374,0.000090026,0.000094655,0.000098899,0.000093454,0.000097783,0.000139191,0.000143620},
{0.000144231,0.000138001,0.000099722,0.000093619,0.000098267,0.000095040,0.000092031,0.000090467,0.000088670,0.000086324,0.000086876,0.000086234,0.000085672,0.000087357,0.000085589,0.000088357,0.000089729,0.000092226,0.000094616,0.000098356,0.000092847,0.000098074,0.000136832,0.000146269},
{0.000143399,0.000136513,0.000100818,0.000093789,0.000098457,0.000093580,0.000093320,0.000089328,0.000086721,0.000086158,0.000088396,0.000087432,0.000085566,0.000087885,0.000085970,0.000087667,0.000091470,0.000092635,0.000094376,0.000098498,0.000094298,0.000100019,0.000135812,0.000143426},
{0.000146647,0.000136992,0.000098895,0.000093336,0.000099056,0.000094638,0.000093606,0.000089297,0.000087650,0.000084171,0.000089327,0.000086801,0.000085868,0.000087567,0.000086460,0.000087848,0.000090543,0.000092613,0.000093884,0.000099776,0.000095004,0.000100934,0.000140652,0.000146073},
{0.000145636,0.000137391,0.000097889,0.000092347,0.000098403,0.000094976,0.000090027,0.000088035,0.000087718,0.000084659,0.000086487,0.000086299,0.000085340,0.000086221,0.000085105,0.000085231,0.000088199,0.000091842,0.000095269,0.000098102,0.000094084,0.000099225,0.000139023,0.000142137},
{0.000145654,0.000140076,0.000100398,0.000093312,0.000097997,0.000094031,0.000089577,0.000088434,0.000087501,0.000085279,0.000087031,0.000085831,0.000084869,0.000086767,0.000084730,0.000086862,0.000088922,0.000092200,0.000092507,0.000098147,0.000091923,0.000098689,0.000134863,0.000145805},
{0.000144412,0.000141221,0.000100989,0.000093669,0.000098481,0.000094126,0.000090637,0.000088996,0.000086481,0.000084626,0.000087215,0.000085209,0.000086411,0.000085720,0.000085971,0.000088033,0.000089293,0.000092436,0.000094674,0.000098109,0.000094653,0.000099974,0.000138386,0.000144675},
{0.000143274,0.000136719,0.000100690,0.000092938,0.000099166,0.000094554,0.000091071,0.000088160,0.000087527,0.000085179,0.000084857,0.000085765,0.000085564,0.000086485,0.000085268,0.000086480,0.000088979,0.000091284,0.000093055,0.000098329,0.000093034,0.000098484,0.000138545,0.000145012},
{0.000146937,0.000139246,0.000100242,0.000094012,0.000098357,0.000093393,0.000090723,0.000088229,0.000087170,0.000084917,0.000087012,0.000086052,0.000085545,0.000086604,0.000084838,0.000086847,0.000088416,0.000091815,0.000094191,0.000098862,0.000094388,0.000100667,0.000138847,0.000146124},
{0.000144298,0.000138818,0.000100287,0.000093833,0.000098525,0.000094651,0.000090770,0.000090340,0.000086084,0.000084607,0.000097294,0.000086780,0.000085113,0.000087008,0.000086018,0.000085652,0.000089461,0.000093813,0.000093276,0.000098405,0.000092340,0.000101192,0.000139729,0.000145126},
{0.000144182,0.000136188,0.000100691,0.000093468,0.000098288,0.000092668,0.000090648,0.000090240,0.000088655,0.000084029,0.000089101,0.000084646,0.000085049,0.000096476,0.000084690,0.000086719,0.000090068,0.000092538,0.000095000,0.000098750,0.000093208,0.000100709,0.000137829,0.000143756},
{0.000143599,0.000141380,0.000099811,0.000091436,0.000098645,0.000093988,0.000090616,0.000090429,0.000085539,0.000086124,0.000087291,0.000086158,0.000085706,0.000098308,0.000086716,0.000086502,0.000089243,0.000091068,0.000094743,0.000098566,0.000094280,0.000099203,0.000138114,0.000148088},
{0.000144789,0.000137030,0.000099895,0.000091283,0.000099787,0.000093710,0.000091593,0.000087372,0.000086375,0.000085686,0.000085276,0.000085691,0.000084618,0.000085897,0.000085725,0.000086203,0.000088953,0.000092704,0.000093555,0.000098240,0.000094105,0.000100259,0.000135950,0.000144827},
{0.000145876,0.000136464,0.000099972,0.000093245,0.000100071,0.000094667,0.000091051,0.000089589,0.000086044,0.000085149,0.000086541,0.000084498,0.000085366,0.000085468,0.000085242,0.000085615,0.000088912,0.000091598,0.000094155,0.000096875,0.000091949,0.000100538,0.000140525,0.000145452},
{0.000145393,0.000135503,0.000100701,0.000092058,0.000099471,0.000093349,0.000091784,0.000090390,0.000087208,0.000084194,0.000087694,0.000084120,0.000086096,0.000085581,0.000084280,0.000086315,0.000092173,0.000092194,0.000093484,0.000097933,0.000093653,0.000100895,0.000137155,0.000143015}};
const double rochcor2015::dcor_maer[16][24]={{0.000143480,0.000136315,0.000100489,0.000091843,0.000099247,0.000093916,0.000091279,0.000088392,0.000087553,0.000085309,0.000086810,0.000084988,0.000085617,0.000085823,0.000085146,0.000087415,0.000090710,0.000091464,0.000092869,0.000098547,0.000092061,0.000101018,0.000136489,0.000147642},
{0.000146551,0.000138216,0.000099145,0.000093005,0.000097653,0.000095000,0.000091333,0.000088472,0.000086473,0.000086130,0.000088251,0.000085333,0.000085684,0.000086363,0.000085184,0.000086928,0.000089374,0.000090026,0.000094655,0.000098899,0.000093454,0.000097783,0.000139191,0.000143620},
{0.000144231,0.000138001,0.000099722,0.000093619,0.000098267,0.000095040,0.000092031,0.000090467,0.000088670,0.000086324,0.000086876,0.000086234,0.000085672,0.000087357,0.000085589,0.000088357,0.000089729,0.000092226,0.000094616,0.000098356,0.000092847,0.000098074,0.000136832,0.000146269},
{0.000143399,0.000136513,0.000100818,0.000093789,0.000098457,0.000093580,0.000093320,0.000089328,0.000086721,0.000086158,0.000088396,0.000087432,0.000085566,0.000087885,0.000085970,0.000087667,0.000091470,0.000092635,0.000094376,0.000098498,0.000094298,0.000100019,0.000135812,0.000143426},
{0.000146647,0.000136992,0.000098895,0.000093336,0.000099056,0.000094638,0.000093606,0.000089297,0.000087650,0.000084171,0.000089327,0.000086801,0.000085868,0.000087567,0.000086460,0.000087848,0.000090543,0.000092613,0.000093884,0.000099776,0.000095004,0.000100934,0.000140652,0.000146073},
{0.000145636,0.000137391,0.000097889,0.000092347,0.000098403,0.000094976,0.000090027,0.000088035,0.000087718,0.000084659,0.000086487,0.000086299,0.000085340,0.000086221,0.000085105,0.000085231,0.000088199,0.000091842,0.000095269,0.000098102,0.000094084,0.000099225,0.000139023,0.000142137},
{0.000145654,0.000140076,0.000100398,0.000093312,0.000097997,0.000094031,0.000089577,0.000088434,0.000087501,0.000085279,0.000087031,0.000085831,0.000084869,0.000086767,0.000084730,0.000086862,0.000088922,0.000092200,0.000092507,0.000098147,0.000091923,0.000098689,0.000134863,0.000145805},
{0.000144412,0.000141221,0.000100989,0.000093669,0.000098481,0.000094126,0.000090637,0.000088996,0.000086481,0.000084626,0.000087215,0.000085209,0.000086411,0.000085720,0.000085971,0.000088033,0.000089293,0.000092436,0.000094674,0.000098109,0.000094653,0.000099974,0.000138386,0.000144675},
{0.000143274,0.000136719,0.000100690,0.000092938,0.000099166,0.000094554,0.000091071,0.000088160,0.000087527,0.000085179,0.000084857,0.000085765,0.000085564,0.000086485,0.000085268,0.000086480,0.000088979,0.000091284,0.000093055,0.000098329,0.000093034,0.000098484,0.000138545,0.000145012},
{0.000146937,0.000139246,0.000100242,0.000094012,0.000098357,0.000093393,0.000090723,0.000088229,0.000087170,0.000084917,0.000087012,0.000086052,0.000085545,0.000086604,0.000084838,0.000086847,0.000088416,0.000091815,0.000094191,0.000098862,0.000094388,0.000100667,0.000138847,0.000146124},
{0.000144298,0.000138818,0.000100287,0.000093833,0.000098525,0.000094651,0.000090770,0.000090340,0.000086084,0.000084607,0.000097294,0.000086780,0.000085113,0.000087008,0.000086018,0.000085652,0.000089461,0.000093813,0.000093276,0.000098405,0.000092340,0.000101192,0.000139729,0.000145126},
{0.000144182,0.000136188,0.000100691,0.000093468,0.000098288,0.000092668,0.000090648,0.000090240,0.000088655,0.000084029,0.000089101,0.000084646,0.000085049,0.000096476,0.000084690,0.000086719,0.000090068,0.000092538,0.000095000,0.000098750,0.000093208,0.000100709,0.000137829,0.000143756},
{0.000143599,0.000141380,0.000099811,0.000091436,0.000098645,0.000093988,0.000090616,0.000090429,0.000085539,0.000086124,0.000087291,0.000086158,0.000085706,0.000098308,0.000086716,0.000086502,0.000089243,0.000091068,0.000094743,0.000098566,0.000094280,0.000099203,0.000138114,0.000148088},
{0.000144789,0.000137030,0.000099895,0.000091283,0.000099787,0.000093710,0.000091593,0.000087372,0.000086375,0.000085686,0.000085276,0.000085691,0.000084618,0.000085897,0.000085725,0.000086203,0.000088953,0.000092704,0.000093555,0.000098240,0.000094105,0.000100259,0.000135950,0.000144827},
{0.000145876,0.000136464,0.000099972,0.000093245,0.000100071,0.000094667,0.000091051,0.000089589,0.000086044,0.000085149,0.000086541,0.000084498,0.000085366,0.000085468,0.000085242,0.000085615,0.000088912,0.000091598,0.000094155,0.000096875,0.000091949,0.000100538,0.000140525,0.000145452},
{0.000145393,0.000135503,0.000100701,0.000092058,0.000099471,0.000093349,0.000091784,0.000090390,0.000087208,0.000084194,0.000087694,0.000084120,0.000086096,0.000085581,0.000084280,0.000086315,0.000092173,0.000092194,0.000093484,0.000097933,0.000093653,0.000100895,0.000137155,0.000143015}};
const double rochcor2015::mcor_bfer[16][24]={{0.000148312,0.000143091,0.000107706,0.000098204,0.000105942,0.000100322,0.000097919,0.000093905,0.000094727,0.000091377,0.000093322,0.000091280,0.000092066,0.000092097,0.000090303,0.000094560,0.000097316,0.000097950,0.000098763,0.000106464,0.000098090,0.000107247,0.000143994,0.000155756},
{0.000152721,0.000145905,0.000105175,0.000097981,0.000103206,0.000102070,0.000096767,0.000094370,0.000092759,0.000091909,0.000095814,0.000090857,0.000091530,0.000092252,0.000091181,0.000093242,0.000094753,0.000095788,0.000101182,0.000106912,0.000101107,0.000103064,0.000147290,0.000149067},
{0.000149707,0.000145488,0.000105757,0.000101108,0.000104559,0.000101067,0.000097133,0.000096098,0.000095617,0.000091729,0.000092812,0.000092403,0.000090807,0.000092689,0.000091747,0.000094999,0.000096189,0.000097889,0.000100789,0.000104931,0.000099142,0.000104953,0.000146398,0.000153315},
{0.000152714,0.000144833,0.000107930,0.000099541,0.000105202,0.000098828,0.000099837,0.000095298,0.000092158,0.000092220,0.000092975,0.000093064,0.000090616,0.000094084,0.000091750,0.000094264,0.000096713,0.000099038,0.000099995,0.000104679,0.000099649,0.000106018,0.000143952,0.000150167},
{0.000154909,0.000145957,0.000106043,0.000100799,0.000106633,0.000101621,0.000100638,0.000095201,0.000093560,0.000089574,0.000095369,0.000091680,0.000090343,0.000093452,0.000092659,0.000093856,0.000096688,0.000098739,0.000100451,0.000105629,0.000102298,0.000105737,0.000149418,0.000151686},
{0.000151269,0.000146577,0.000103728,0.000098651,0.000105038,0.000102259,0.000095180,0.000092911,0.000093537,0.000090378,0.000092125,0.000092164,0.000091578,0.000091670,0.000091198,0.000090559,0.000093130,0.000098683,0.000102694,0.000105018,0.000101506,0.000105805,0.000147994,0.000147959},
{0.000154396,0.000148164,0.000107116,0.000100397,0.000105593,0.000100385,0.000095294,0.000094488,0.000093258,0.000091622,0.000091724,0.000091541,0.000090528,0.000093627,0.000090555,0.000093075,0.000095486,0.000099024,0.000098399,0.000104626,0.000097916,0.000105358,0.000140992,0.000152322},
{0.000150924,0.000150567,0.000107243,0.000098818,0.000105950,0.000101261,0.000095891,0.000094367,0.000091674,0.000090419,0.000092982,0.000090596,0.000091641,0.000091334,0.000093323,0.000095092,0.000094201,0.000098478,0.000100893,0.000104042,0.000101854,0.000107067,0.000148072,0.000149641},
{0.000151065,0.000141589,0.000107309,0.000099057,0.000106322,0.000101746,0.000097004,0.000093717,0.000094503,0.000091781,0.000090363,0.000091235,0.000091747,0.000092069,0.000091493,0.000092872,0.000095337,0.000097418,0.000099927,0.000105106,0.000099129,0.000104017,0.000147601,0.000151272},
{0.000154765,0.000147551,0.000106318,0.000101040,0.000105326,0.000100442,0.000097892,0.000094257,0.000094201,0.000090640,0.000092000,0.000093356,0.000091267,0.000091689,0.000091172,0.000093431,0.000094289,0.000098007,0.000101639,0.000105772,0.000101679,0.000106774,0.000147291,0.000155119},
{0.000151300,0.000146177,0.000107937,0.000100151,0.000104904,0.000101477,0.000096438,0.000095623,0.000092486,0.000089078,0.000099366,0.000092946,0.000090484,0.000093450,0.000091403,0.000092243,0.000095514,0.000100684,0.000099276,0.000104666,0.000097949,0.000109101,0.000146369,0.000154014},
{0.000154452,0.000143987,0.000108279,0.000100290,0.000105833,0.000099627,0.000096867,0.000095536,0.000095444,0.000089786,0.000094750,0.000089897,0.000089815,0.000099878,0.000090236,0.000092733,0.000096163,0.000099097,0.000100809,0.000105738,0.000099966,0.000107816,0.000145866,0.000151757},
{0.000151635,0.000148935,0.000106377,0.000097294,0.000106171,0.000100228,0.000095561,0.000096441,0.000090314,0.000092063,0.000092513,0.000091759,0.000091053,0.000098257,0.000091868,0.000091404,0.000093774,0.000096267,0.000102268,0.000106041,0.000100790,0.000105370,0.000147613,0.000156113},
{0.000152560,0.000145158,0.000107185,0.000097920,0.000107986,0.000099053,0.000098667,0.000092841,0.000091864,0.000092016,0.000090520,0.000091593,0.000090363,0.000091070,0.000091832,0.000091991,0.000093770,0.000099914,0.000100120,0.000106531,0.000102002,0.000107001,0.000144035,0.000154986},
{0.000155569,0.000146146,0.000106291,0.000099936,0.000107963,0.000101185,0.000097306,0.000095982,0.000091024,0.000090252,0.000092741,0.000089444,0.000091095,0.000092132,0.000091570,0.000091454,0.000094746,0.000098797,0.000100427,0.000103161,0.000098365,0.000107593,0.000150298,0.000155447},
{0.000153724,0.000141273,0.000106909,0.000096402,0.000106356,0.000099005,0.000098113,0.000096335,0.000093316,0.000090678,0.000094506,0.000089773,0.000091894,0.000090963,0.000090119,0.000091930,0.000094754,0.000097393,0.000101122,0.000105056,0.000100953,0.000106980,0.000145833,0.000150294}};
const double rochcor2015::mcor_maer[16][24]={{0.000148312,0.000143091,0.000107706,0.000098204,0.000105942,0.000100322,0.000097919,0.000093905,0.000094727,0.000091377,0.000093322,0.000091280,0.000092066,0.000092097,0.000090303,0.000094560,0.000097316,0.000097950,0.000098763,0.000106464,0.000098090,0.000107247,0.000143994,0.000155756},
{0.000152721,0.000145905,0.000105175,0.000097981,0.000103206,0.000102070,0.000096767,0.000094370,0.000092759,0.000091909,0.000095814,0.000090857,0.000091530,0.000092252,0.000091181,0.000093242,0.000094753,0.000095788,0.000101182,0.000106912,0.000101107,0.000103064,0.000147290,0.000149067},
{0.000149707,0.000145488,0.000105757,0.000101108,0.000104559,0.000101067,0.000097133,0.000096098,0.000095617,0.000091729,0.000092812,0.000092403,0.000090807,0.000092689,0.000091747,0.000094999,0.000096189,0.000097889,0.000100789,0.000104931,0.000099142,0.000104953,0.000146398,0.000153315},
{0.000152714,0.000144833,0.000107930,0.000099541,0.000105202,0.000098828,0.000099837,0.000095298,0.000092158,0.000092220,0.000092975,0.000093064,0.000090616,0.000094084,0.000091750,0.000094264,0.000096713,0.000099038,0.000099995,0.000104679,0.000099649,0.000106018,0.000143952,0.000150167},
{0.000154909,0.000145957,0.000106043,0.000100799,0.000106633,0.000101621,0.000100638,0.000095201,0.000093560,0.000089574,0.000095369,0.000091680,0.000090343,0.000093452,0.000092659,0.000093856,0.000096688,0.000098739,0.000100451,0.000105629,0.000102298,0.000105737,0.000149418,0.000151686},
{0.000151269,0.000146577,0.000103728,0.000098651,0.000105038,0.000102259,0.000095180,0.000092911,0.000093537,0.000090378,0.000092125,0.000092164,0.000091578,0.000091670,0.000091198,0.000090559,0.000093130,0.000098683,0.000102694,0.000105018,0.000101506,0.000105805,0.000147994,0.000147959},
{0.000154396,0.000148164,0.000107116,0.000100397,0.000105593,0.000100385,0.000095294,0.000094488,0.000093258,0.000091622,0.000091724,0.000091541,0.000090528,0.000093627,0.000090555,0.000093075,0.000095486,0.000099024,0.000098399,0.000104626,0.000097916,0.000105358,0.000140992,0.000152322},
{0.000150924,0.000150567,0.000107243,0.000098818,0.000105950,0.000101261,0.000095891,0.000094367,0.000091674,0.000090419,0.000092982,0.000090596,0.000091641,0.000091334,0.000093323,0.000095092,0.000094201,0.000098478,0.000100893,0.000104042,0.000101854,0.000107067,0.000148072,0.000149641},
{0.000151065,0.000141589,0.000107309,0.000099057,0.000106322,0.000101746,0.000097004,0.000093717,0.000094503,0.000091781,0.000090363,0.000091235,0.000091747,0.000092069,0.000091493,0.000092872,0.000095337,0.000097418,0.000099927,0.000105106,0.000099129,0.000104017,0.000147601,0.000151272},
{0.000154765,0.000147551,0.000106318,0.000101040,0.000105326,0.000100442,0.000097892,0.000094257,0.000094201,0.000090640,0.000092000,0.000093356,0.000091267,0.000091689,0.000091172,0.000093431,0.000094289,0.000098007,0.000101639,0.000105772,0.000101679,0.000106774,0.000147291,0.000155119},
{0.000151300,0.000146177,0.000107937,0.000100151,0.000104904,0.000101477,0.000096438,0.000095623,0.000092486,0.000089078,0.000099366,0.000092946,0.000090484,0.000093450,0.000091403,0.000092243,0.000095514,0.000100684,0.000099276,0.000104666,0.000097949,0.000109101,0.000146369,0.000154014},
{0.000154452,0.000143987,0.000108279,0.000100290,0.000105833,0.000099627,0.000096867,0.000095536,0.000095444,0.000089786,0.000094750,0.000089897,0.000089815,0.000099878,0.000090236,0.000092733,0.000096163,0.000099097,0.000100809,0.000105738,0.000099966,0.000107816,0.000145866,0.000151757},
{0.000151635,0.000148935,0.000106377,0.000097294,0.000106171,0.000100228,0.000095561,0.000096441,0.000090314,0.000092063,0.000092513,0.000091759,0.000091053,0.000098257,0.000091868,0.000091404,0.000093774,0.000096267,0.000102268,0.000106041,0.000100790,0.000105370,0.000147613,0.000156113},
{0.000152560,0.000145158,0.000107185,0.000097920,0.000107986,0.000099053,0.000098667,0.000092841,0.000091864,0.000092016,0.000090520,0.000091593,0.000090363,0.000091070,0.000091832,0.000091991,0.000093770,0.000099914,0.000100120,0.000106531,0.000102002,0.000107001,0.000144035,0.000154986},
{0.000155569,0.000146146,0.000106291,0.000099936,0.000107963,0.000101185,0.000097306,0.000095982,0.000091024,0.000090252,0.000092741,0.000089444,0.000091095,0.000092132,0.000091570,0.000091454,0.000094746,0.000098797,0.000100427,0.000103161,0.000098365,0.000107593,0.000150298,0.000155447},
{0.000153724,0.000141273,0.000106909,0.000096402,0.000106356,0.000099005,0.000098113,0.000096335,0.000093316,0.000090678,0.000094506,0.000089773,0.000091894,0.000090963,0.000090119,0.000091930,0.000094754,0.000097393,0.000101122,0.000105056,0.000100953,0.000106980,0.000145833,0.000150294}};

//==========================================================================================================================

const double rochcor2015::dd[12]={0.00444322,0.00599786,0.00868451,0.0132134,0.0187774,0.026975,0.0269519,0.0335465,0.0264274,0.0426582,0.0542414,0.0678064};
const double rochcor2015::md[12]={0.00112396,-0.00036625,0.0012901,0.00468771,0.0069031,0.00791988,0.00562021,0.00578948,0.0101969,0.0132028,0.0174836,0.0233148};
const double rochcor2015::dder[12]={0.000887706,0.000988568,0.00104266,0.0011258,0.0013214,0.00169656,0.00199157,0.00221473,0.00250299,0.00328545,0.00536185,0.0114783};
const double rochcor2015::mder[12]={0.000772053,-0.000846141,0.000907464,0.000973487,0.00110896,0.00141362,0.00160058,0.00173683,0.00177956,0.00233241,0.00369364,0.00538745};

const double rochcor2015::dscl[24]={0.999499,0.999788,0.999726,0.999564,0.999471,0.999466,0.999899,1.00014,1.00026,0.999838,1.0006,1.00003,1.00104,0.999942,1.00021,1.00032,1.00048,0.99985,0.999823,0.999381,0.999542,0.998855,0.99935,0.998597};
const double rochcor2015::mscl[24]={1.0002,1.00006,0.999715,0.99988,0.999967,1.00003,0.999922,0.99997,1.00069,1.00033,1.00013,1.00004,1.00052,0.999985,1.00019,1.00036,1.0004,1.00004,0.999654,0.999916,1.00023,1.00031,1.0003,1.00042};

RocRes2015 muresol1;

//===============================================================================================

rochcor2015::~rochcor2015(){
}

rochcor2015::rochcor2015(std::string inputFile){

  muresol1.init(inputFile);
  //muresol1.dumpParams();
  
  eran.SetSeed(123456);
  sran.SetSeed(1234);
  
  gscler_mc_dev=0;
  gscler_da_dev=0;

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=0;
          mptsys_mc_da[i][j]=0;
          mptsys_da_dm[i][j]=0;
          mptsys_da_da[i][j]=0;
      }
  }

}

rochcor2015::rochcor2015(std::string inputFile, int seed){

  muresol1.init(inputFile);

  eran.SetSeed(123456);
  sran.SetSeed(seed);

  gscler_mc_dev=sran.Gaus(0.0, 1.0);
  gscler_da_dev=sran.Gaus(0.0, 1.0);

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_mc_da[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_da[i][j]=sran.Gaus(0.0, 1.0);
      }
  }
}

void rochcor2015::momcor_mc( TLorentzVector& mu, float charge, int ntrk, float& qter){
  
  //sysdev == num : deviation = num
  double mupt_bfcor = mu.Pt();
  double mupt = mu.Pt();
  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root

  //double px = mu.Px();
  //double py = mu.Py();
  //double pz = mu.Pz();
  //double e = mu.E();

  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);
  
  if(mu_phibin>=0 && mu_etabin>=0){
    
    double Mf = (mcor_bf[mu_phibin][mu_etabin] + mptsys_mc_dm[mu_phibin][mu_etabin]*mcor_bfer[mu_phibin][mu_etabin])/(mpavg[mu_phibin][mu_etabin]+mmavg[mu_phibin][mu_etabin]);
    double Af = ((mcor_ma[mu_phibin][mu_etabin]+mptsys_mc_da[mu_phibin][mu_etabin]*mcor_maer[mu_phibin][mu_etabin]) - Mf*(mpavg[mu_phibin][mu_etabin]-mmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*mupt);
    
    //for the momentum tuning - eta,phi,Q correction
    mupt *= cor;
    
    double gscl = (genm_smr/mrecm);
    double gscler = mgscl_stat;    

    double u = eran.Rndm();
    double w = eran.Rndm();
    double tune = muresol1.kExtraDet(mupt,mueta,ntrk,u,w);

    mupt *= (gscl + gscler_mc_dev*gscler)*(tune*mscl[mu_etabin]);    
    
    //dE/dx correction for low pt is not available in rereco version yet
    double pt_tune = (mupt-md[mu_aetabin])*45.0/(45.0-md[mu_aetabin]);
    mupt = pt_tune;
    
    double momscl = mupt_bfcor/mupt;
    qter *= sqrt(momscl*momscl + (1.0-tune)*(1.0-tune));
    
  }
  
  mu.SetPtEtaPhiM(mupt,mueta,muphi,mu_mass);
}


void rochcor2015::momcor_data( TLorentzVector& mu, float charge, int runopt, float& qter){
  
  double mupt_bfcor = mu.Pt();
  double mupt = mu.Pt();
  
  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root
  
  //double px = mu.Px();
  //double py = mu.Py();
  //double pz = mu.Pz();
  //double e = mu.E();
  
  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);

  if(mu_phibin>=0 && mu_etabin>=0){
    
    double Mf = (dcor_bf[mu_phibin][mu_etabin]+mptsys_da_dm[mu_phibin][mu_etabin]*dcor_bfer[mu_phibin][mu_etabin])/(dpavg[mu_phibin][mu_etabin]+dmavg[mu_phibin][mu_etabin]);
    double Af = ((dcor_ma[mu_phibin][mu_etabin]+mptsys_da_da[mu_phibin][mu_etabin]*dcor_maer[mu_phibin][mu_etabin]) - Mf*(dpavg[mu_phibin][mu_etabin]-dmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*mupt);
    
    mupt *= cor;  
    
    //after Z pt correction
    double gscl = (genm_smr/drecm);
    double gscler = dgscl_stat;

    mupt *= (gscl + gscler_da_dev*gscler)*dscl[mu_etabin];
    
    //dE/dx correction for low pt is not available in rereco version yet
    double pt_tune = (mupt-dd[mu_aetabin])*45.0/(45.0-dd[mu_aetabin]);
    mupt = pt_tune; 
    
    double momscl = mupt_bfcor/mupt;
    qter *= momscl;
    
  }
  
  mu.SetPtEtaPhiM(mupt,mueta,muphi,mu_mass);
  
}

Int_t rochcor2015::phibin(double phi){
  
  int nphibin = -1;
  
  for(int i=0; i<16; i++){
    if(-pi+(2.0*pi/16.0)*i <= phi && -pi+(2.0*pi/16.0)*(i+1) > phi){
      nphibin = i;
      break;
    }
  }
  
  return nphibin;
}

Int_t rochcor2015::etabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<24; i++){
    if(netabin[i] <= eta && netabin[i+1] > eta){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}



Int_t rochcor2015::aetabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<12; i++){
    if(anetabin[i] <= fabs(eta) && anetabin[i+1] > fabs(eta)){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}

